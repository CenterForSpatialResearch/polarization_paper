<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="../favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <title>Network Tolerances</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src="https://code.jquery.com/jquery-1.12.3.min.js"></script>
    <script src="../lib/d3.v5.min.js"></script>
    <script src="../lib/colors.js"></script>
      <link rel="stylesheet" href="style.css">


</head>
<body>
   <div id="all">
       <div id="title">Network Tolerances</div>
       <div id ="info">Adjust the tolerance of the network, then add links to see how the network will grow.<br/>
          </div>
       
      
    <!--
      <div id="triadicInfo">  <strong>*Triadic Closure:</strong> Triadic closure refers to the linking of a and c in a situation where a and b are linked and b and c are linked - those creating a ridgid triangle in the network. 
              In our simulation, we combine the idea of having the most in common with triadic closure by prioritizing the formation of links between a node and its neighbor's neighbor with the most neighbors in common (whose linking would also automatically create a triadic closure)<br/>
             <strong> NOTE:</strong> in order to create triadic closures between nodes in the network, you must already have linked nodes to build upon.</div>-->
    
   <div class="slidecontainer">
     <div class="sliderBox" id="t">
        <span id="tolerance"><strong>Tolerance:</strong> Between 0% and 100% </span>
        <br/>
        <input type="range" min="1" max="100" value="10" class="slider" id="growthInput">
        <span id="growthValue">value</span>
      </div>  
      
     <div class="sliderBox" id="l">
          <strong>Total Number of Links:</strong> Between 0 and 1000 Links<br>
        <input type="range" min="0" max="1000" value="0" class="slider sliderLinksAdded" id="linksAddedInput">
        <span id="linksAddedValue">value</span>
      </div>   
      
   </div>
   
    <div id="chart1"></div>
    
    </div>
    
    <div id="hideTolerance"></div>
    
<script type="text/javascript"> 
var triadicMode = false
    
    
d3.select("#triadic")
    .style("cursor","pointer")
    .on("click",function(){ 
        if(triadicMode==true){
            triadicMode=false
            d3.select("#triadic").style("font-weight","normal").html("Triadic Closure*: OFF<br/><br/>")
            d3.select("#hideTolerance").style("visibility","hidden")
        }else{
            triadicMode=true 
            d3.select("#triadic").style("font-weight","bold").html("Triadic Closure*: ON<br/><br/>")
            d3.select("#hideTolerance").style("visibility","visible")
        }
    })
    
var downloadInterval = 500
    
var svg = d3.select("#chart1").append("svg")
   // .attr("width",window.innerWidth)
    .attr("width",800)
    .attr("height",window.innerHeight)
var width = +svg.attr("width")
var height = +svg.attr("height")

var distance = 50
var strength = -100
    
var size = 100

var thresholdStart =.1//var thresholdStart = parseInt(document.getElementById("startingInput").value)/100;
var threshold =parseInt(document.getElementById("growthInput").value)/100;
    
var groups = 2
var friendsToMake = 0
    
//var newFriendships =100

var interval = 5

var nodes = []
var links = []


makeNetworkData(thresholdStart)
 
d3.select("#setup").html("SETUP<br>size: "+size+"<br>friends each: "+friendsToMake+"<br>"+"start tolerance: "+thresholdStart
    +"<br>tolerance: "+threshold)
  
var groupColor = {
    _0:"#00aeef",
    _1:"#fff200",
    _2:"#fff"
}
var nodeRadius = 4
var strokeColor = "#000000"
var strokeWidth = 1

function makeNetworkData(threshold){
    nodes =[]
    links =[]
    for(var i = 0; i<size; i++){
        var groupNumber ="_"+Math.round(Math.random()*(groups-1))    
        nodes.push({id:"node_"+i,group:groupNumber})
    }
    var linksTracker = []
    for(var n in nodes){
        var existingFriends = 0
        while(existingFriends<friendsToMake){
            var source = nodes[n]
            var randomIndex = Math.round(Math.random()*(nodes.length-1))
            var target = nodes[randomIndex]
            if(Math.random()<threshold){
                while(target.group == source.group || source.id == target.id){
                    target = nodes[Math.round(Math.random()*(nodes.length-1))]
                }
            }else{
                while(target.group != source.group || source.id == target.id){
                    target = nodes[Math.round(Math.random()*(nodes.length-1))]
                }
            }
        
            if(parseInt(source.id.split("_")[1])<parseInt(target.id.split("_")[1])){
                var link = {source:source, target:target}
            }else{
                var link = {source:target, target:source}
            }
            
            var currentLinkIds = link.source.id+"_"+link.target.id
            
            if(linksTracker.indexOf(currentLinkIds)==-1){
                links.push(link)
                linksTracker.push(currentLinkIds)
                existingFriends+=1
            }
        }
    }
    var homophily = 0
    for(var l in links){
        if(links[l].source.group==links[l].target.group){
            homophily+=1
        }
    }
}

function ticked() {
    
  node.attr("cx", function(d) { return d.x; })
      .attr("cy", function(d) { return d.y; })

  link.attr("x1", function(d) { return d.source.x; })
      .attr("y1", function(d) { return d.source.y; })
      .attr("x2", function(d) { return d.target.x; })
      .attr("y2", function(d) { return d.target.y; });
} 

</script>
<script src="inputControl.js"></script>
<script src="add_triadic.js"></script>
<script src="count.js"></script>
<script src="timeline.js"></script>

</body>
</html>